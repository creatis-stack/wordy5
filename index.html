// Export functionality
  const exportProgress = () => {
    const exportData = {
      currentWeek,
      userProfile,
      wordsStudied: Array.from({length: currentWeek + 1}, (_, i) => getWeeklyWord(i)),
      exportDate: new Date().toISOString()
    };
    
    const dataStr = JSON.stringify(exportData, null, 2);
    navigator.clipboard.writeText(dataStr);
    alert('Progress copied to clipboard! You can paste this into an email or document.');
  };import React, { useState, useEffect } from 'react';
import { ChevronLeft, Volume2, TrendingUp, TrendingDown } from 'lucide-react';

const VocabularyBuilder = () => {
  const [currentWeek, setCurrentWeek] = useState(0);
  const [currentExample, setCurrentExample] = useState(0);
  const [userProfile, setUserProfile] = useState({ difficulty: 0 }); // -2 to +2 scale
  const [startDate] = useState(() => {
    const saved = localStorage.getItem('vocabStartDate');
    return saved ? new Date(saved) : new Date();
  });

  // Calculate current week and day based on actual time elapsed
  useEffect(() => {
    const now = new Date();
    const timeDiff = now.getTime() - startDate.getTime();
    const daysPassed = Math.floor(timeDiff / (1000 * 60 * 60 * 24));
    
    const calculatedWeek = Math.floor(daysPassed / 7);
    const calculatedExample = daysPassed % 7;
    
    setCurrentWeek(calculatedWeek);
    setCurrentExample(calculatedExample);
    
    // Save start date for persistence
    localStorage.setItem('vocabStartDate', startDate.toISOString());
  }, [startDate]);

  // Conversational vocabulary database with difficulty ratings
  const vocabularyDatabase = [
    // Difficulty -2 (easier conversational words)
    {
      word: "articulate",
      pronunciation: "/…ërÀàt…™ky…ôl…™t/",
      partOfSpeech: "adjective/verb",
      meaning: "expressing thoughts clearly and effectively; to speak distinctly",
      difficulty: -2,
      examples: [
        "Maya found herself struggling to articulate the weight of her mother's expectations during dinner conversations that stretched long into the evening, each word carefully chosen yet never quite capturing the complexity of her feelings about the arranged marriage proposal.",
        "The professor's articulate explanation of quantum mechanics reminded Elena of her father's patient way of describing the monsoon seasons‚Äîboth men possessed that rare gift of making the incomprehensible feel suddenly, beautifully clear.",
        "In the cramped apartment above the grocery store, Ravi watched his daughter articulate her dreams of medical school with such precision that he could almost see the stethoscope around her neck, though his own words of encouragement felt clumsy in comparison.",
        "The way Kamala could articulate the exact shade of homesickness‚Äînot the sharp pang of missing a person, but the dull ache of missing a version of yourself‚Äîmade her friends understand why she spent hours writing letters home.",
        "During the neighborhood association meeting, Mrs. Chen's articulate defense of the community garden revealed not just her passion for growing vegetables, but her deep understanding of how shared spaces could heal the loneliness of urban life.",
        "As the wedding approached, Deepa found it increasingly difficult to articulate why she felt like she was watching her life happen to someone else, the Bengali words for doubt feeling too heavy on her tongue.",
        "The child's articulate questions about why his grandfather only spoke Tamil at home but English everywhere else revealed a wisdom that made the adults in the room fall silent with recognition."
      ]
    },
    {
      word: "nuanced",
      pronunciation: "/Àànu…ënst/",
      partOfSpeech: "adjective",
      meaning: "having subtle differences in expression, meaning, or response",
      difficulty: -1,
      examples: [
        "Priya's relationship with her mother-in-law required a nuanced understanding of when silence meant disapproval and when it meant deep thought, a skill she was still learning after three years of marriage.",
        "The flavors in her grandmother's curry were impossibly nuanced‚Äîcardamom that whispered rather than shouted, turmeric that painted warmth without overwhelming, each spice added with the precision of someone who had perfected the recipe across decades.",
        "Living between two cultures demanded a nuanced approach to identity that Arjun's American-born friends couldn't quite grasp, the way he could shift between versions of himself as naturally as changing languages.",
        "The nuanced way her father expressed love‚Äîthrough extra helpings of rice, through staying up late to help with homework, through never saying the words directly‚Äîhad taken her years to recognize and appreciate.",
        "In the bookstore where she worked, Meera developed a nuanced understanding of her customers' needs, knowing that the woman who browsed poetry on Tuesdays was working through grief, while the man who lingered in philosophy was questioning his career.",
        "The conflict between her Indian parents' expectations and her own ambitions required nuanced navigation, each conversation a careful dance between respect and rebellion.",
        "His writing captured the nuanced experience of growing up bilingual, where some emotions could only be expressed in one language, leaving parts of himself perpetually untranslatable."
      ]
    },
    // Difficulty 0 (standard conversational words)
    {
      word: "pragmatic",
      pronunciation: "/pr√¶gÀàm√¶t…™k/",
      partOfSpeech: "adjective",
      meaning: "practical rather than idealistic; focused on what works",
      difficulty: 0,
      examples: [
        "After years of dreaming about returning to India, Sunita took a pragmatic approach to her parents' aging, accepting that love sometimes meant staying in Boston rather than following romantic notions of homeland.",
        "The pragmatic decision to rent out the basement apartment helped the Patels maintain their mortgage, though it meant sharing their American dream with strangers who left curry smells in the hallway.",
        "Reshma's pragmatic nature emerged during wedding planning when she suggested buffet-style service over plated dinners, knowing that feeding three hundred guests required logistics, not just tradition.",
        "His mother's pragmatic advice about choosing a spouse‚Äî'Love will grow, but compatibility must exist from the beginning'‚Äîseemed cold until he watched friends divorce over irreconcilable differences.",
        "The pragmatic choice would have been to major in engineering like his brothers, but Vikram's heart pulled him toward literature, creating a tension between family expectations and personal truth.",
        "In the aftermath of her father's stroke, Kavya discovered her own pragmatic strength, navigating insurance forms and medical decisions with a competence that surprised everyone, including herself.",
        "The pragmatic arrangement of living with his in-laws during the first years of marriage allowed them to save money for a house, though it required daily negotiations of privacy and independence."
      ]
    },
    {
      word: "compelling",
      pronunciation: "/k…ômÀàp…õl…™≈ã/",
      partOfSpeech: "adjective",
      meaning: "evoking interest or attention in a powerful way; convincing",
      difficulty: 0,
      examples: [
        "There was something compelling about the way her aunt told stories of their village in Punjab, each detail painted with such vivid precision that Anita could smell the mustard fields and hear the temple bells across the ocean.",
        "The compelling argument for keeping the family restaurant open wasn't financial‚Äîit was the way customers spoke of the place as their refuge, where the dal tasted like their mother's and the owner remembered their names.",
        "His compelling presence at family gatherings had nothing to do with being the loudest voice; instead, it was his ability to listen deeply, making even the shyest cousins feel heard and valued.",
        "The most compelling reason to learn Hindi wasn't to please her grandparents, but to understand the poetry they quoted, to access the emotional language that English couldn't quite capture.",
        "There was a compelling honesty in the way her teenage daughter questioned their traditions, forcing the entire family to examine which customs served them and which had simply become habit.",
        "The compelling nature of her homesickness wasn't just missing India, but missing the version of herself who belonged there completely, without explanation or translation.",
        "His compelling vision for the community center focused not on the building itself, but on creating a space where immigrants could feel less alone in navigating their new country."
      ]
    },
    {
      word: "perceptive",
      pronunciation: "/p…ôrÀàs…õpt…™v/",
      partOfSpeech: "adjective",
      meaning: "having keen insight and understanding; quick to notice things",
      difficulty: 1,
      examples: [
        "Even as a child, Leela was perceptive enough to notice that her mother cooked different foods when they had Indian guests versus American ones, understanding instinctively the code-switching required for survival.",
        "The perceptive way her grandmother read people's faces made family gatherings feel like watching a master class in human nature, each raised eyebrow and pursed lip translated into precise social intelligence.",
        "His perceptive observation that their father grew quieter each December‚Äîthe anniversary of leaving Bangladesh‚Äîhelped the family understand why the holidays carried an undercurrent of melancholy.",
        "With perceptive clarity, she realized that her mother's criticism of her career choices wasn't about the job itself, but about the fear that success might take her daughter too far from home.",
        "The perceptive questions her five-year-old asked about why some people at the temple looked different from others revealed a child's natural ability to notice what adults had learned to ignore.",
        "Her perceptive understanding of office dynamics helped her navigate being the only Indian woman on the executive team, reading the subtle signals that others missed entirely.",
        "Through perceptive observation of her neighbors, Mrs. Krishnan learned that loneliness spoke many languages but always wore the same expression of carefully maintained politeness."
      ]
    },
    // Difficulty +2 (sophisticated conversational words)
    {
      word: "discerning",
      pronunciation: "/d…™Ààs…úrn…™≈ã/",
      partOfSpeech: "adjective",
      meaning: "showing good judgment and understanding; selective and refined",
      difficulty: 2,
      examples: [
        "Her discerning palate, trained on her mother's complex curries, could detect the difference between garam masala ground fresh and the pre-mixed version from the Indian grocery store, a skill that connected her to generations of women who cooked by intuition.",
        "The discerning way he chose which traditions to maintain in his American household‚Äîkeeping the daily prayers but abandoning the restrictions on his daughter's friendships‚Äîreflected years of careful thought about identity and adaptation.",
        "With discerning precision, she curated her wardrobe to navigate both worlds, knowing that the same sari that made her feel elegant at Indian weddings would draw stares at her law firm.",
        "His discerning approach to dating involved looking beyond surface compatibility to find someone who understood the weight of family expectations without being crushed by them.",
        "The discerning art collector had an eye for pieces that spoke to the immigrant experience, each painting and sculpture in her gallery telling stories of displacement and belonging.",
        "Her discerning choice of which battles to fight with her traditional parents‚Äîpushing back on career limitations while respecting their religious practices‚Äîshowed a wisdom beyond her years.",
        "The discerning reader could see that his novel wasn't just about one family's journey from Calcutta to California, but about the universal struggle to plant roots in foreign soil while keeping the memory of home alive."
      ]
    }
  ];

  // Get word based on user's difficulty profile
  const getWeeklyWord = (weekIndex) => {
    const adjustedDifficulty = userProfile.difficulty;
    const availableWords = vocabularyDatabase.filter(word => 
      Math.abs(word.difficulty - adjustedDifficulty) <= 1
    );
    
    if (availableWords.length === 0) {
      return vocabularyDatabase[weekIndex % vocabularyDatabase.length];
    }
    
    return availableWords[weekIndex % availableWords.length];
  };

  const currentWord = getWeeklyWord(currentWeek);



  // Difficulty adjustment
  const adjustDifficulty = (direction) => {
    setUserProfile(prev => ({
      ...prev,
      difficulty: Math.max(-2, Math.min(2, prev.difficulty + direction))
    }));
  };

  // Audio pronunciation
  const speakWord = (text) => {
    if ('speechSynthesis' in window) {
      // Stop any current speech
      speechSynthesis.cancel();
      
      const utterance = new SpeechSynthesisUtterance(text);
      utterance.rate = 0.7; // Slower for clarity
      utterance.pitch = 1.0;
      utterance.volume = 1.0;
      
      // Try to use a higher quality voice if available
      const voices = speechSynthesis.getVoices();
      const englishVoice = voices.find(voice => 
        voice.lang.startsWith('en') && voice.name.includes('Enhanced')
      ) || voices.find(voice => voice.lang.startsWith('en'));
      
      if (englishVoice) {
        utterance.voice = englishVoice;
      }
      
      speechSynthesis.speak(utterance);
    } else {
      alert('Speech synthesis not supported in this browser');
    }
  };

  // Export functionality
  const exportProgress = () => {
    const exportData = {
      currentWeek,
      userProfile,
      wordsStudied: Array.from({length: currentWeek + 1}, (_, i) => getWeeklyWord(i)),
      exportDate: new Date().toISOString()
    };
    
    const dataStr = JSON.stringify(exportData, null, 2);
    navigator.clipboard.writeText(dataStr);
    alert('Progress copied to clipboard! You can paste this into an email or document.');
  };

  return (
    <div className="min-h-screen bg-gradient-to-br from-blue-900 via-purple-900 to-indigo-900 text-white p-6">
      <div className="max-w-4xl mx-auto">
        {/* Header */}
        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold mb-2">Weekly Vocabulary Builder</h1>
          <p className="text-blue-200">Week {currentWeek + 1} ‚Ä¢ Conversational Level</p>
        </div>

        {/* Main Word Card */}
        <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-8 mb-6 border border-white/20">
          <div className="text-center mb-6">
            <h2 className="text-5xl font-bold text-yellow-300 mb-4">{currentWord.word}</h2>
            <div className="flex items-center justify-center gap-4 mb-4">
              <span className="text-xl text-blue-200">{currentWord.pronunciation}</span>
              <button 
                onClick={() => speakWord(currentWord.word)}
                className="p-2 bg-blue-600 hover:bg-blue-700 rounded-full transition-colors hover:scale-105 active:scale-95"
                title="Listen to pronunciation"
              >
                <Volume2 size={20} />
              </button>
            </div>
            <p className="text-lg text-purple-200 italic mb-4">{currentWord.partOfSpeech}</p>
            <p className="text-xl leading-relaxed">{currentWord.meaning}</p>
          </div>
        </div>

        {/* Daily Example */}
        <div className="bg-white/10 backdrop-blur-lg rounded-2xl p-6 mb-6 border border-white/20">
          <div className="flex items-center justify-between mb-4">
            <h3 className="text-2xl font-semibold">Today's Contextual Usage</h3>
            <span className="text-sm text-blue-200">
              Day {currentExample + 1}
            </span>
          </div>
          <div className="text-lg leading-relaxed text-yellow-200 border-l-4 border-yellow-400 pl-6 italic">
            {currentWord.examples[currentExample]}
          </div>
        </div>

        {/* Controls */}
        <div className="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
          {/* Week Navigation */}
          <div className="bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20">
            <h4 className="font-semibold mb-3">Review Past Words</h4>
            <div className="flex justify-start">
              <button 
                onClick={() => setCurrentWeek(Math.max(0, currentWeek - 1))}
                disabled={currentWeek === 0}
                className="px-4 py-2 bg-indigo-600 hover:bg-indigo-700 disabled:bg-gray-600 disabled:cursor-not-allowed rounded-lg transition-colors"
              >
                ‚Üê Previous Week
              </button>
            </div>
            <p className="text-xs text-blue-200 mt-2">Words advance automatically every 7 days</p>
          </div>

          {/* Difficulty Control */}
          <div className="bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20">
            <h4 className="font-semibold mb-3">Future Word Difficulty</h4>
            <div className="flex justify-between items-center">
              <button 
                onClick={() => adjustDifficulty(-1)}
                className="flex items-center gap-1 px-3 py-2 bg-green-600 hover:bg-green-700 rounded-lg transition-colors"
              >
                <TrendingDown size={16} /> Easier
              </button>
              <span className="font-mono">{userProfile.difficulty > 0 ? '+' : ''}{userProfile.difficulty}</span>
              <button 
                onClick={() => adjustDifficulty(1)}
                className="flex items-center gap-1 px-3 py-2 bg-red-600 hover:bg-red-700 rounded-lg transition-colors"
              >
                <TrendingUp size={16} /> Harder
              </button>
            </div>
          </div>
        </div>

        {/* Weekly Progress */}
        <div className="bg-white/10 backdrop-blur-lg rounded-xl p-4 border border-white/20 mb-6">
          <div className="flex justify-between items-center mb-4">
            <h4 className="font-semibold">Weekly Progress</h4>
            <span className="text-sm">{currentWeek + 1} weeks completed</span>
          </div>
          <div className="grid grid-cols-7 gap-1 mb-4">
            {Array.from({length: 7}, (_, i) => (
              <div 
                key={i}
                className={`h-8 rounded flex items-center justify-center text-xs ${
                  i < ((currentExample + 1) % 7) || currentExample >= 6 
                    ? 'bg-green-500' 
                    : 'bg-white/20'
                }`}
              >
                {i + 1}
              </div>
            ))}
          </div>
          <div className="text-sm text-blue-200 text-center">
            Day {currentExample + 1} of Week {currentWeek + 1} ‚Ä¢ {currentExample >= 6 ? 'Week completed!' : `${7 - (currentExample + 1)} days until next word`}
          </div>
        </div>

        {/* Audio Note */}
        <div className="text-center text-sm text-blue-200">
          <p>üîä Click the volume button to hear pronunciation (uses device's built-in voice)</p>
        </div>
      </div>
    </div>
  );
};

export default VocabularyBuilder;
